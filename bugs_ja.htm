<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bug Patterns - Find Security Bugs</title>

    <link rel="shortcut icon" href="images/favicon.png">
    <link href="http://fonts.googleapis.com/css?family=Squada+One" rel="stylesheet" type="text/css"/>
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/font-awesome.css" rel="stylesheet">
    <link href="css/fsb-custom-theme.css" rel="stylesheet">
    <link href="css/agency.css" rel="stylesheet">

    <meta http-equiv="refresh" content="0;url=http://find-sec-bugs.github.io/bugs_ja.htm">
    <script type="text/javascript">
    if(window.location.host != "find-sec-bugs.github.io") {
        window.location.host = "find-sec-bugs.github.io";
    }
    </script>

    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>


<nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">Find Security Bugs</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class=''><a href="/find-sec-bugs/">Home</a></li>
                <li class="dropdown ">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">How To <span class="caret"></span></a>
                    <ul class="dropdown-menu" role="menu">
                        <li class="dropdown-header">Use the plugin with..</li>
                        <li><a href="tutorials.htm#Maven">Maven</a></li>
                        <li><a href="tutorials.htm#Eclipse">Eclipse</a></li>
                        <li><a href="tutorials.htm#NetBeans">NetBeans</a></li>
                        <li><a href="tutorials.htm#IntelliJ">IntelliJ</a></li>
                        <li><a href="tutorials.htm#Jenkins">Jenkins</a></li>
                        <li><a href="tutorials.htm#Sonar">Sonar</a></li>
                        <li class="divider"></li>
                        <li class="dropdown-header">Knowledge base</li>
                        <li><a href="security.htm">Getting started in security</a></li>
                    </ul>
                </li>
                <li class='active'><a href="bugs.htm">Bug Patterns</a></li>
                <li ><a href="download.htm">Download</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li ><a href="license.htm">License</a></li>
            </ul>
        </div><!--/.nav-collapse -->
    </div>
</nav>

<br/><br/>


<div class="container">
    <div class="jumbotron jumbotron-ad hidden-print">

        <h1><i class="fa fa-crosshairs"></i>&nbsp; Bugs Patterns</h1>

        <p>The complete list of descriptions given when FindBugs identify potential weaknesses.</p>

    </div>
</div>






<div class="container">
    <div class="row">
        <div class="col-md-11" id="mainCol">

    
    <section>
        <a class="anchor" name="PREDICTABLE_RANDOM"></a><h2 class="page-header">????????????  <a href="#PREDICTABLE_RANDOM" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>?????????????????????????????????????????????????????????????????????????????</p>
<ul>
<li>CSRF ????</li>
<li>????????????? (???????????)</li>
<li>????????</li>
</ul>
<p>
?????????? <b>java.util.Random</b> ???? <b>java.security.SecureRandom</b> ?????????????????????
</p>
<p>
<b>??????:</b><br/>
<pre>String generateSecretToken() {
    Random r = new Random();
    return Long.toHexString(r.nextLong());
}</pre>
</p>
<p>
<b>???:</b>
<pre>import org.apache.commons.codec.binary.Hex;

String generateSecretToken() {
    SecureRandom secRandom = new SecureRandom();

    byte[] result = new byte[32];
    secRandom.nextBytes(result);
    return Hex.encodeHexString(result);
}</pre>
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://jazzy.id.au/default/2010/09/20/cracking_random_number_generators_part_1.html">Cracking Random Number Generators - Part 1 (http://jazzy.id.au)</a><br/>
<a href="https://www.securecoding.cert.org/confluence/display/java/MSC02-J.+Generate+strong+random+numbers">CERT: MSC02-J. Generate strong random numbers</a><br/>
<a href="http://cwe.mitre.org/data/definitions/330.html">CWE-330: Use of Insufficiently Random Values</a><br/>
<a href="http://blog.h3xstream.com/2014/12/predicting-struts-csrf-token-cve-2014.html">Predicting Struts CSRF Token (Example of real-life vulnerability and exploitation)</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="SERVLET_PARAMETER"></a><h2 class="page-header">??????????????????  <a href="#SERVLET_PARAMETER" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>???????????????? GET ? POST ??????????????????????????????????????
????????????? API ?????????????????????????????????????</p>
<ul>
<li>SQL ???? (SQL ????????????????)</li>
<li>???????? (????????????????)</li>
<li>????????????????????????</li>
<li>HTML?????????? XSS?</li>
<li>??...</li>
</ul>

<br/>
<p>
<b>????</b><br/>
<a href="http://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="SERVLET_CONTENT_TYPE"></a><h2 class="page-header">?????? Content-Type ????  <a href="#SERVLET_CONTENT_TYPE" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
HTTP ???? Content-Type ??????????????????????????????????????????????????????
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://cwe.mitre.org/data/definitions/807.html">CWE-807: Untrusted Inputs in a Security Decision</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="SERVLET_SERVER_NAME"></a><h2 class="page-header">?????? Host ????  <a href="#SERVLET_SERVER_NAME" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>Host ??????????????????????????????????????????????????????????
<code>ServletRequest.getServerName()</code> ? <code>HttpServletRequest.getHeader("Host")</code> ??
???? <code>Host</code> ?????????????????????</p>
<pre>
GET /testpage HTTP/1.1
Host: www.example.com
[...]</pre>
<p>
??????????????????????????????????????????????????????????????????
??????????????????????????????????????????
?????????????????????????????????????????????
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://cwe.mitre.org/data/definitions/807.html">CWE-807: Untrusted Inputs in a Security Decision</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="SERVLET_SESSION_ID"></a><h2 class="page-header">?????????????????  <a href="#SERVLET_SESSION_ID" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
???? <a href="http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#getRequestedSessionId()"><code>HttpServletRequest.getRequestedSessionId()</code></a> ?????? <code>JSESSIONID</code> ???????????
????????????????????????????????????????????
</p>
<p>
???????????????????????? (??? <code>JSESSIONID=jp6q31lq2myn</code>)???????????????????????????????
??? HTTP ?????????????????????????
<pre>
GET /somePage HTTP/1.1
Host: yourwebsite.com
User-Agent: Mozilla/5.0
Cookie: JSESSIONID=Any value of the user&#39;s choice!!??'''&quot;&gt;
</pre>
</p>
<p>?????JSESSIONID ?????????????? ID ??????????????????????????????????????????????????????????????????
????????? ID ??????????????????????????????????????????? ID ?????????ID ????????????????????????????????????????????????????
</p>
<br/>
<p>
<b>????</b><br/>
<a href="https://www.owasp.org/index.php/Session_Management_Cheat_Sheet">OWASP: Session Management Cheat Sheet</a><br/>
<a href="http://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="SERVLET_QUERY_STRING"></a><h2 class="page-header">?????????????  <a href="#SERVLET_QUERY_STRING" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>?????????GET ????????????????????????????????????????????</p>
<p>URL ?????? <code>/app/servlet.htm?a=1&b=2</code> ?????????????????? <code>a=1&b=2</code> ?????? </p>
<p><code>HttpServletRequest.getParameter()</code> ?????????????????????????????????
<code>HttpServletRequest.getQueryString()</code> ??????????????????????
??????? API ????????????????????????????????????????????????
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="SERVLET_HEADER"></a><h2 class="page-header">?????? HTTP ????  <a href="#SERVLET_HEADER" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>????????????????????????????????????????????
?????????????????????????????????????????????????????
??????????????????????????????????????????????????????</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://cwe.mitre.org/data/definitions/807.html">CWE-807: Untrusted Inputs in a Security Decision</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="SERVLET_HEADER_REFERER"></a><h2 class="page-header">?????? Referer ????  <a href="#SERVLET_HEADER_REFERER" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
??:
<ul>
<li>?????????????????????????????????????????????????</li>
<li>???????? (https) ????????????????????"Referer" ????????</li>
</ul>
</p>
<p>
????:
<ul>
<li>???????????????????????????????????</li>
<li>CSRF ??????????????????????????(<a href="http://www.w3.org/Protocols/HTTP/HTRQ_Headers.html#z14">?????????????</a>)</li>
</ul>
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://cwe.mitre.org/data/definitions/807.html">CWE-807: Untrusted Inputs in a Security Decision</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="SERVLET_HEADER_USER_AGENT"></a><h2 class="page-header">?????? User-Agent ????  <a href="#SERVLET_HEADER_USER_AGENT" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>???? "User-Agent" ?????????????????????????????????????????? (????? UA ????) ?????????????????????</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://cwe.mitre.org/data/definitions/807.html">CWE-807: Untrusted Inputs in a Security Decision</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="COOKIE_USAGE"></a><h2 class="page-header">???????????????  <a href="#COOKIE_USAGE" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>????????????????????????????????????????????????????????????????????????????????????????????????????????
HttpSession (HttpServletRequest.getSession()) ??????????</p>
<p>????????????????????????????????????????????????????????</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://cwe.mitre.org/data/definitions/315.html">CWE-315: Cleartext Storage of Sensitive Information in a Cookie</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="PATH_TRAVERSAL_IN"></a><h2 class="page-header">???????????? (????????)  <a href="#PATH_TRAVERSAL_IN" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>????????????????????????????????<b>??</b>??????????????? 
???????????????????????? API ??????????????????????????????????????????</p>
<p>??????<b>????</b>???????????????????????????????????????????????????????????????????????????????</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://projects.webappsec.org/w/page/13246952/Path%20Traversal">WASC: Path Traversal</a><br/>
<a href="https://www.owasp.org/index.php/Path_Traversal">OWASP: Path Traversal</a><br/>
<a href="http://capec.mitre.org/data/definitions/126.html">CAPEC-126: Path Traversal</a><br/>
<a href="http://cwe.mitre.org/data/definitions/22.html">CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="PATH_TRAVERSAL_OUT"></a><h2 class="page-header">???????????? (????????)  <a href="#PATH_TRAVERSAL_OUT" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>????????????????????????????????<b>??</b>??????????????? 
???????????????????????? API ??????????????????????????????????????????</p>
<p>??????<b>????</b>???????????????????????????????????????????????????????????????????????????????</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://projects.webappsec.org/w/page/13246952/Path%20Traversal">WASC-33: Path Traversal</a><br/>
<a href="https://www.owasp.org/index.php/Path_Traversal">OWASP: Path Traversal</a><br/>
<a href="http://capec.mitre.org/data/definitions/126.html">CAPEC-126: Path Traversal</a><br/>
<a href="http://cwe.mitre.org/data/definitions/22.html">CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="COMMAND_INJECTION"></a><h2 class="page-header">????????????????  <a href="#COMMAND_INJECTION" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>??????? API ????????????????????????????????????????????? API ???????????????????????????????</p>
<br/>
<p>
<b>????</b><br/>
<a href="https://www.owasp.org/index.php/Command_Injection">OWASP: Command Injection</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A1-Injection">OWASP: Top 10 2013-A1-Injection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/78.html">CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="WEAK_FILENAMEUTILS"></a><h2 class="page-header">FilenameUtils ? Null ??????????????  <a href="#WEAK_FILENAMEUTILS" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>????? FilenameUtils ?????? NULL ??? (<code>0x00</code>) ???????????</p>
<p>Null ??????????????????????? OS ?????????????????? Null ?????????????????????????
OS ???????????? Java ??? Null ????????????????????????????? Null ????????????
?? OS ??????????????????????? (??????? ".log" ????) ??????????????????????????????????????????????????????</p>
<p>??????????2 ?????????????:
<ul>
<li>Java 7 update 40 ?????? Java 8 ???????????
<a href="http://bugs.java.com/bugdatabase/view_bug.do?bug_id=8014846">??????? NULL ???????????????????????????????</a>?</li>
<li>??????????????????????????????????????????????????? (?????null ???????????????????????????)?</li>
</ul>
<p>Null ???????????????????????????? Java ????????????????????????????????????
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://projects.webappsec.org/w/page/13246949/Null%20Byte%20Injection">WASC-28: Null Byte Injection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/158.html">CWE-158: Improper Neutralization of Null Byte or NUL Character</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="WEAK_TRUST_MANAGER"></a><h2 class="page-header">TrustManager ????  <a href="#WEAK_TRUST_MANAGER" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>?? TrustManager ?????????????<a href="http://en.wikipedia.org/wiki/Certificate_authority">???</a>?????????????????????????????????
????????????????????????????????<a href="http://en.wikipedia.org/wiki/Man-in-the-middle_attack">?????</a>?????????
</p>
<p>
(????truststore ?????) ??????????? TrustManager ?????????????
??????????????????:
<a href="http://stackoverflow.com/a/6378872/89769">[1]</a>
<a href="http://stackoverflow.com/a/5493452/89769">[2]</a>
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://projects.webappsec.org/w/page/13246945/Insufficient%20Transport%20Layer%20Protection">WASC-04: Insufficient Transport Layer Protection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/295.html">CWE-295: Improper Certificate Validation</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="JAXWS_ENDPOINT"></a><h2 class="page-header">JAX-WS SOAP ??????????  <a href="#JAXWS_ENDPOINT" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>????????SOAP Web ???? (JSR224) ??????</p>
<p>
<b>?? Web ????????????????????????:</b>
<ul>
<li>?????????????????????????</li>
<li>?????????????????????????????</li>
<li>????????????????????????</li>
<li>???????? SSL ???????????????</li>
</ul>
</p>
<br/>
<p>
<b>????</b><br/>
<a href="https://www.owasp.org/index.php/Web_Service_Security_Cheat_Sheet">OWASP: Web Service Security Cheat Sheet</a><br/>
<a href="http://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="JAXRS_ENDPOINT"></a><h2 class="page-header">JAX-RS REST ??????????  <a href="#JAXRS_ENDPOINT" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>??????? REST Web ???? (JSR311) ??????</p>
<p>
<b>?? Web ????????????????????????:</b>
<ul>
<li>?????????????????????????</li>
<li>?????????????????????????????</li>
<li>????????????????????????</li>
<li>???????? SSL ???????????????</li>
<li>?????????????????? (??? POST ????) ???CSRF ???????????????????? <sup>[1]</sup></li>
</ul>
</p>
<br/>
<p>
<b>????</b><br/>
<a href="https://www.owasp.org/index.php/REST_Assessment_Cheat_Sheet">OWASP: REST Assessment Cheat Sheet</a><br/>
<a href="https://www.owasp.org/index.php/REST_Security_Cheat_Sheet">OWASP: REST Security Cheat Sheet</a><br/>
<a href="https://www.owasp.org/index.php/Web_Service_Security_Cheat_Sheet">OWASP: Web Service Security Cheat Sheet</a><br/>
1. <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)">OWASP: Cross-Site Request Forgery</a><br/>
<a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet">OWASP: CSRF Prevention Cheat Sheet</a><br/>
<a href="http://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="TAPESTRY_ENDPOINT"></a><h2 class="page-header">Tapestry ??????  <a href="#TAPESTRY_ENDPOINT" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>Tapestry ?????????????????????????????Tapestry ??????????????? Java ???????? Tapestry ??????????? (.tml ????) ??????????
?????????????GET/POST ???????????? Java ?????????????????????
?????????????????<br/>???????:</p>
<pre><code>
    [...]
    protected String input;
    [...]
</code></pre>
<p>???????????????????:
</p>
<pre><code>
    [...]
    @org.apache.tapestry5.annotations.Parameter
    protected String parameter1;

    @org.apache.tapestry5.annotations.Component(id = "password")
    private PasswordField passwordField;
    [...]
</code></pre>
<p>???????? <code>[/resources/package/PageName].tml ???????????</code></p>
<p>???????????? Tapestry ??????????????????????????????????????????????????????????????????????</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://tapestry.apache.org/">Apache Tapestry Home Page</a><br/>
<a href="http://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="WICKET_ENDPOINT"></a><h2 class="page-header">Wicket ??????  <a href="#WICKET_ENDPOINT" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>???????Wicket ? WebPage ?????? ???????????????? PageParameters ????????????????????
???????? ??? [/package/WebPageName].html ???????????</p>
<p>???????????? Wicket ??????????????????????????????????????????????????????????????????????</p>
<br/>
<p>
<b>????</b><br/>
<a href="https://wicket.apache.org/">Apache Wicket Home Page</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="WEAK_MESSAGE_DIGEST"></a><h2 class="page-header">?????????????  <a href="#WEAK_MESSAGE_DIGEST" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>?????????????????????????????????????</p>
<p><a href="http://csrc.nist.gov/groups/ST/toolkit/secure_hashing.html">NIST</a> ??SHA-1? SHA-224*? SHA-256? SHA-384? SHA-512? SHA-512/224? ??? SHA-512/256 ????????????</p>
<p><small>* SHA-224 ??????? <a href="http://docs.oracle.com/javase/6/docs/technotes/guides/security/SunProviders.html#SUNProvider">SUN ??????</a>???????????</small></p>
<p>????????????????????????????????????????????????????????????????????????????????</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://csrc.nist.gov/groups/ST/toolkit/secure_hashing.html">NIST Approved Hashing Algorithms</a><br/>
<a href="http://cwe.mitre.org/data/definitions/327.html">CWE-327: Use of a Broken or Risky Cryptographic Algorithm</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="CUSTOM_MESSAGE_DIGEST"></a><h2 class="page-header">??????????????  <a href="#CUSTOM_MESSAGE_DIGEST" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>????????????????????????????????????</p>
<p><a href="http://csrc.nist.gov/groups/ST/toolkit/secure_hashing.html">NIST</a> ??SHA-1? SHA-224*? SHA-256? SHA-384? SHA-512? SHA-512/224? ??? SHA-512/256 ????????????</p>
<p><small>* SHA-224 ??????? <a href="http://docs.oracle.com/javase/6/docs/technotes/guides/security/SunProviders.html#SUNProvider">SUN ??????</a>???????????</small></p>
<p>
    <b>??????:</b><br/>
<pre>MyProprietaryMessageDigest extends MessageDigest {
    @Override
    protected byte[] engineDigest() {
        [...]
        // ???????????????
        return [...];
    }
}</pre>
</p>
<p>
<p>????????????????????????????????????????????????????????????????????????????????</p>
<p>
    <b>???:</b><br/>
<pre>MessageDigest sha256Digest = MessageDigest.getInstance("SHA256");
sha256Digest.update(password.getBytes());</pre>
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://csrc.nist.gov/groups/ST/toolkit/secure_hashing.html">NIST Approved Hashing Algorithms</a><br/>
<a href="http://cwe.mitre.org/data/definitions/327.html">CWE-327: Use of a Broken or Risky Cryptographic Algorithm</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="FILE_UPLOAD_FILENAME"></a><h2 class="page-header">???????????????  <a href="#FILE_UPLOAD_FILENAME" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>?????????? API ????????????????????????????????????????????????????????????</p>
<p>???:</p>
<ul>
<li><code>"../../../config/overide_file"</code></li>
<li><code>"shell.jsp\u0000expected.gif"</code></li>
</ul>
<p>????????????????????? API ???????????????
??????????????????????????????????????
????????????????????????????????? (????/ \)??????????????????????????????????????????????????????????????</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://blogs.securiteam.com/index.php/archives/1268">Securiteam: File upload security recommendations</a><br/>
<a href="http://cwe.mitre.org/data/definitions/22.html">CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')</a><br/>
<a href="http://projects.webappsec.org/w/page/13246952/Path%20Traversal">WASC-33: Path Traversal</a><br/>
<a href="https://www.owasp.org/index.php/Path_Traversal">OWASP: Path Traversal</a><br/>
<a href="http://capec.mitre.org/data/definitions/126.html">CAPEC-126: Path Traversal</a><br/>
<a href="http://cwe.mitre.org/data/definitions/22.html">CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="REDOS"></a><h2 class="page-header">??????? DoS (ReDoS)  <a href="#REDOS" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
    ???? (regexs) ???????????? (DoS) ?????????? (ReDoS ??????)?
    ???????????????????????????????????????????????????????????
<p>
    ???? ?????????: <b>^(a+)+$</b>? ?? "<code>aaaaaaaaaaaaaaaaX</code>" ?????????? 665535 ???????????????????
    <sup>[1] OWASP ?????????????</sup></p>
<p>
?????????????????????????????????????????
??????(???????????)????????????????? + (??? *) ????????? + (??? *) ???????????????????????????? 2 ??????????
??????????? + ???? 'a' ????????
???????????????????????????????????????
????<b>^a+$</b> ?????????????????????????????????????????? (a ?????????) ?
??????????????????????????????????ReDoS ??????????
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://www.jroller.com/sebastianKuebeck/entry/detecting_and_preventing_redos_vulnerabilities">Sebastian Kubeck's Weblog: Detecting and Preventing ReDoS Vulnerabilities</a><br/>
<sup>[1]</sup> <a href="https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS">OWASP: Regular expression Denial of Service</a><br/>
<a href="http://cwe.mitre.org/data/definitions/400.html">CWE-400: Uncontrolled Resource Consumption ('Resource Exhaustion')</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="XXE_SAXPARSER"></a><h2 class="page-header">XXE ???? XML ?? (SAXParser)  <a href="#XXE_SAXPARSER" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<!--XXE_GENERIC_START-->
<h3>??</h3>
<p>???????????????? XML ??????XML ????? XML ?????????????????XML ???????? (XXE) ????????????????</p>
<p><b>??? 1: ?????????????? (XXE: <u>X</u>ML e<u>X</u>ternal <u>E</u>ntity)</b></p>
<p>
<pre>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
&lt;!DOCTYPE foo [
   &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt; ]&gt;
&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</pre>
</p>
<b>??? 2: ?????? (XEE: <u>X</u>ml <u>E</u>ntity <u>E</u>xpansion)</b>
<p>
<pre>
&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;!DOCTYPE lolz [
 &lt;!ENTITY lol &quot;lol&quot;&gt;
 &lt;!ELEMENT lolz (#PCDATA)&gt;
 &lt;!ENTITY lol1 &quot;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&quot;&gt;
 &lt;!ENTITY lol2 &quot;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&quot;&gt;
 &lt;!ENTITY lol3 &quot;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&quot;&gt;
[...]
 &lt;!ENTITY lol9 &quot;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&quot;&gt;
]&gt;
&lt;lolz&gt;&lol9;&lt;/lolz&gt;</pre>
</p>

<h3>???</h3>
<p>
XML??????????????????????????????????????????
</p>
<!--XXE_GENERIC_END-->

<p><b>??????:</b></p>
<p>
<pre>
SAXParser parser = SAXParserFactory.newInstance().newSAXParser();

parser.parse(inputStream, customHandler);</pre>
</p>

<p><b>"Secure processing" ???????????:</b></p>
<p>
<pre>
SAXParserFactory spf = SAXParserFactory.newInstance();
spf.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);
SAXParser parser = spf.newSAXParser();

parser.parse(inputStream, customHandler);</pre>
</p>

<p><b>DTD ?????????:</b></p>
<p>
<pre>
SAXParserFactory spf = SAXParserFactory.newInstance();
spf.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);
SAXParser parser = spf.newSAXParser();

parser.parse(inputStream, customHandler);</pre>
</p>
<br/>
<p>
<b>????</b><br/>
<!--XXE_GENERIC_START-->
<a href="http://cwe.mitre.org/data/definitions/611.html">CWE-611: Improper Restriction of XML External Entity Reference ('XXE')</a><br/>
<a href="https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=61702260">CERT: IDS10-J. Prevent XML external entity attacks</a><br/>
<a href="https://www.owasp.org/index.php/XML_External_Entity_%28XXE%29_Processing">OWASP.org: XML External Entity (XXE) Processing</a><br/>
<a href="http://www.ws-attacks.org/index.php/XML_Entity_Expansion">WS-Attacks.org: XML Entity Expansion</a><br/>
<a href="http://www.ws-attacks.org/index.php/XML_External_Entity_DOS">WS-Attacks.org: XML External Entity DOS</a><br/>
<a href="http://www.ws-attacks.org/index.php/XML_Entity_Reference_Attack">WS-Attacks.org: XML Entity Reference Attack</a><br/>
<!--XXE_GENERIC_END-->
<a href="http://xerces.apache.org/xerces-j/features.html">Xerces complete features list</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="XXE_XMLREADER"></a><h2 class="page-header">XXE ???? XML ??  (XMLReader)  <a href="#XXE_XMLREADER" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<!--XXE_GENERIC_START-->
<h3>??</h3>
<p>???????????????? XML ??????XML ????? XML ?????????????????XML ???????? (XXE) ????????????????</p>
<p><b>??? 1: ?????????????? (XXE: <u>X</u>ML e<u>X</u>ternal <u>E</u>ntity)</b></p>
<p>
<pre>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
&lt;!DOCTYPE foo [
   &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt; ]&gt;
&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</pre>
</p>
<b>??? 2: ?????? (XEE: <u>X</u>ml <u>E</u>ntity <u>E</u>xpansion)</b>
<p>
<pre>
&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;!DOCTYPE lolz [
 &lt;!ENTITY lol &quot;lol&quot;&gt;
 &lt;!ELEMENT lolz (#PCDATA)&gt;
 &lt;!ENTITY lol1 &quot;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&quot;&gt;
 &lt;!ENTITY lol2 &quot;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&quot;&gt;
 &lt;!ENTITY lol3 &quot;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&quot;&gt;
[...]
 &lt;!ENTITY lol9 &quot;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&quot;&gt;
]&gt;
&lt;lolz&gt;&lol9;&lt;/lolz&gt;</pre>
</p>

<h3>???</h3>
<p>
XML??????????????????????????????????????????
</p>
<!--XXE_GENERIC_END-->

<p><b>??????:</b></p>
<p>
<pre>
XMLReader reader = XMLReaderFactory.createXMLReader();
reader.setContentHandler(customHandler);
reader.parse(new InputSource(inputStream));</pre>
</p>

<p><b>"Secure processing" ???????????:</b></p>
<p>
<pre>
XMLReader reader = XMLReaderFactory.createXMLReader();
reader.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);
reader.setContentHandler(customHandler);

reader.parse(new InputSource(inputStream));</pre>
</p>

<p><b>DTD ?????????:</b></p>
<p>
<pre>
XMLReader reader = XMLReaderFactory.createXMLReader();
reader.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);
reader.setContentHandler(customHandler);

reader.parse(new InputSource(inputStream));</pre>
</p>
<br/>
<p>
<b>????</b><br/>
<!--XXE_GENERIC_START-->
<a href="http://cwe.mitre.org/data/definitions/611.html">CWE-611: Improper Restriction of XML External Entity Reference ('XXE')</a><br/>
<a href="https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=61702260">CERT: IDS10-J. Prevent XML external entity attacks</a><br/>
<a href="https://www.owasp.org/index.php/XML_External_Entity_%28XXE%29_Processing">OWASP.org: XML External Entity (XXE) Processing</a><br/>
<a href="http://www.ws-attacks.org/index.php/XML_Entity_Expansion">WS-Attacks.org: XML Entity Expansion</a><br/>
<a href="http://www.ws-attacks.org/index.php/XML_External_Entity_DOS">WS-Attacks.org: XML External Entity DOS</a><br/>
<a href="http://www.ws-attacks.org/index.php/XML_Entity_Reference_Attack">WS-Attacks.org: XML Entity Reference Attack</a><br/>
<!--XXE_GENERIC_END-->
<a href="http://xerces.apache.org/xerces-j/features.html">Xerces complete features list</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="XXE_DOCUMENT"></a><h2 class="page-header">XXE ???? XML ?? (DocumentBuilder)  <a href="#XXE_DOCUMENT" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<!--XXE_GENERIC_START-->
<h3>??</h3>
<p>???????????????? XML ??????XML ????? XML ?????????????????XML ???????? (XXE) ????????????????</p>
<p><b>??? 1: ?????????????? (XXE: <u>X</u>ML e<u>X</u>ternal <u>E</u>ntity)</b></p>
<p>
<pre>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
&lt;!DOCTYPE foo [
   &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt; ]&gt;
&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</pre>
</p>
<b>??? 2: ?????? (XEE: <u>X</u>ml <u>E</u>ntity <u>E</u>xpansion)</b>
<p>
<pre>
&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;!DOCTYPE lolz [
 &lt;!ENTITY lol &quot;lol&quot;&gt;
 &lt;!ELEMENT lolz (#PCDATA)&gt;
 &lt;!ENTITY lol1 &quot;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&quot;&gt;
 &lt;!ENTITY lol2 &quot;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&quot;&gt;
 &lt;!ENTITY lol3 &quot;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&quot;&gt;
[...]
 &lt;!ENTITY lol9 &quot;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&quot;&gt;
]&gt;
&lt;lolz&gt;&lol9;&lt;/lolz&gt;</pre>
</p>

<h3>???</h3>
<p>
XML??????????????????????????????????????????
</p>
<!--XXE_GENERIC_END-->

<p><b>??????:</b></p>
<p>
<pre>
DocumentBuilder db = DocumentBuilderFactory.newInstance().newDocumentBuilder();

Document doc = db.parse(input);</pre>
</p>

<p><b>"Secure processing" ???????????:</b></p>
<p>
<pre>
DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
dbf.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);
DocumentBuilder db = dbf.newDocumentBuilder();

Document doc = db.parse(input);</pre>
</p>

<p><b>DTD ?????????:</b></p>
<p>
<pre>
DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
dbf.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);
DocumentBuilder db = dbf.newDocumentBuilder();

Document doc = db.parse(input);</pre>
</p>
<br/>
<p>
<b>????</b><br/>
<!--XXE_GENERIC_START-->
<a href="http://cwe.mitre.org/data/definitions/611.html">CWE-611: Improper Restriction of XML External Entity Reference ('XXE')</a><br/>
<a href="https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=61702260">CERT: IDS10-J. Prevent XML external entity attacks</a><br/>
<a href="https://www.owasp.org/index.php/XML_External_Entity_%28XXE%29_Processing">OWASP.org: XML External Entity (XXE) Processing</a><br/>
<a href="http://www.ws-attacks.org/index.php/XML_Entity_Expansion">WS-Attacks.org: XML Entity Expansion</a><br/>
<a href="http://www.ws-attacks.org/index.php/XML_External_Entity_DOS">WS-Attacks.org: XML External Entity DOS</a><br/>
<a href="http://www.ws-attacks.org/index.php/XML_Entity_Reference_Attack">WS-Attacks.org: XML Entity Reference Attack</a><br/>
<!--XXE_GENERIC_END-->
<a href="http://xerces.apache.org/xerces2-j/features.html">Xerces2 complete features list</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="XPATH_INJECTION"></a><h2 class="page-header">???? XPath ????????  <a href="#XPATH_INJECTION" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
XPath ??????????????SQL ???????????????XPath ?????????????????????????????????????????????????
???????????????????????????????XML?????????????????????
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://projects.webappsec.org/w/page/13246963/SQL%20Injection">WASC-39: XPath Injection</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A1-Injection">OWASP: Top 10 2013-A1-Injection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/643.html">CWE-643: Improper Neutralization of Data within XPath Expressions ('XPath Injection')</a><br/>
<a href="https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=61407250">CERT: IDS09-J. Prevent XPath Injection (archive)</a><br/>
<a href="http://media.blackhat.com/bh-eu-12/Siddharth/bh-eu-12-Siddharth-Xpath-WP.pdf">Black Hat Europe 2012: Hacking XPath 2.0</a><br/>
<a href="http://www.balisage.net/Proceedings/vol7/html/Vlist02/BalisageVol7-Vlist02.html">Balisage: XQuery Injection</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="STRUTS1_ENDPOINT"></a><h2 class="page-header">Struts 1 ????? ???  <a href="#STRUTS1_ENDPOINT" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>??????  Struts 1 ????????</p>
<p>???????????????????????????Form ??????? HTTP ??????????????????????????
???????????????????????????????????????????????????</p>

        
    </section>
    
    <section>
        <a class="anchor" name="STRUTS2_ENDPOINT"></a><h2 class="page-header">Struts 2 ???????????  <a href="#STRUTS2_ENDPOINT" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>Struts 2 ??????????????????? Java ?????? (POJO) ???????????????/??????/?????????????????</p>
<p>??????????????? (????????) ????????????????? HTTP ??????????????????????????????
????????????????????????????????????????????????????????????????
?????????????????????????????????????????????????????????????????
???????????????????????????????????????????????????</p>

        
    </section>
    
    <section>
        <a class="anchor" name="SPRING_ENDPOINT"></a><h2 class="page-header">Spring ???????????  <a href="#SPRING_ENDPOINT" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>???????Spring ??????????<code>RequestMapping</code> ??????????????????????????????
????????????????????????????????????????????????????????????</p>

        
    </section>
    
    <section>
        <a class="anchor" name="CUSTOM_INJECTION"></a><h2 class="page-header">????????????  <a href="#CUSTOM_INJECTION" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
????????????????????????????????????????????????????????
</p>
<p>
    <b>???????????:</b><br/>
    <pre>SqlUtil.execQuery("select * from UserEntity t where id = " + parameterInput);</pre>
</p>
<br/>
<p>
    <b>?????????????????:</b><br/>
    ????????????????????????<br/>
    <br/>
    ??????????????????:
    <pre>&lt;&lt;??????&gt;&gt;|&lt;&lt;????&gt;&gt;|&lt;&lt;????&gt;&gt;|&lt;&lt;????????????&gt;&gt;=&lt;&lt;????????????????????????&gt;&gt;|&lt;&lt;?????????&gt;&gt;</pre>
    ???:
    <pre>INVOKEVIRTUAL|testcode/sqli/MySqlWrapper|executeQuery|(Ljava/lang/String;)Ljava/sql/ResultSet;=0|CUSTOM_INJECTION
[...]</pre>
    <br/>
    ??????????????????????????????
    <pre>-Dfindsecbugs.injection.sources=${basedir}/rules/InjectionSources.properties</pre>
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://projects.webappsec.org/w/page/13246963/SQL%20Injection">WASC-19: SQL Injection</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A1-Injection">OWASP: Top 10 2013-A1-Injection</a><br/>
<a href="https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet">OWASP: SQL Injection Prevention Cheat Sheet</a><br/>
<a href="https://www.owasp.org/index.php/Query_Parameterization_Cheat_Sheet">OWASP: Query Parameterization Cheat Sheet</a><br/>
<a href="http://capec.mitre.org/data/definitions/66.html">CAPEC-66: SQL Injection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/89.html">CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="SQL_INJECTION_HIBERNATE"></a><h2 class="page-header">???? SQL/HQL ???????? (Hibernate)  <a href="#SQL_INJECTION_HIBERNATE" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
SQL ????????????????????????????
??????????????????????SQL ???????????????????????????????????
??????????????????? Hibernate Criteria ????????
</p>
<p>
    <b>??????:</b><br/>
    <pre>
Session session = sessionFactory.openSession();
Query q = session.createQuery("select t from UserEntity t where id = " + input);
q.execute();</pre>
</p>
<p>
    <b>???:</b><br/>
    <pre>
Session session = sessionFactory.openSession();
Query q = session.createQuery("select t from UserEntity t where id = :userId");
q.setString("userId",input);
q.execute();</pre>
</p>
<p>
    <b>?????????? (Hibernate Criteria ????):</b><br/>
    <pre>
Session session = sessionFactory.openSession();
Query q = session.createCriteria(UserEntity.class)
    .add( Restrictions.like("id", input) )
    .list();
q.execute();</pre>
</p>
<br/>
<p>
<b>???? (Hibernate)</b><br/>
<a href="https://docs.jboss.org/hibernate/orm/3.3/reference/en/html/querycriteria.html">Hibernate Documentation: Query Criteria</a><br/>
<a href="https://docs.jboss.org/hibernate/orm/3.2/api/org/hibernate/Query.html">Hibernate Javadoc: Query Object</a><br/>
<a href="http://blog.h3xstream.com/2014/02/hql-for-pentesters.html">HQL for pentesters</a>: ????????????????????????????<br/>
<b>???? (SQL ????????)</b><br/>
<a href="http://projects.webappsec.org/w/page/13246963/SQL%20Injection">WASC-19: SQL Injection</a><br/>
<a href="http://capec.mitre.org/data/definitions/66.html">CAPEC-66: SQL Injection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/89.html">CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A1-Injection">OWASP: Top 10 2013-A1-Injection</a><br/>
<a href="https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet">OWASP: SQL Injection Prevention Cheat Sheet</a><br/>
<a href="https://www.owasp.org/index.php/Query_Parameterization_Cheat_Sheet">OWASP: Query Parameterization Cheat Sheet</a><br/>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="SQL_INJECTION_JDO"></a><h2 class="page-header">???? SQL/JDOQL ???????? (JDO)  <a href="#SQL_INJECTION_JDO" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
SQL ????????????????????????????
??????????????????????SQL ???????????????????????????????????
</p>
<p>
    <b>??????:</b><br/>
    <pre>
PersistenceManager pm = getPM();

Query q = pm.newQuery("select * from Users where name = " + input);
q.execute();</pre>
</p>
<p>
    <b>???:</b><br/>
    <pre>
PersistenceManager pm = getPM();

Query q = pm.newQuery("select * from Users where name = nameParam");
q.declareParameters("String nameParam");
q.execute(input);</pre>
</p>
<br/>
<p>
<b>???? (JDO)</b><br/>
<a href="https://db.apache.org/jdo/object_retrieval.html">JDO: Object Retrieval</a><br/>
<b>???? (SQL ????????)</b><br/>
<a href="http://projects.webappsec.org/w/page/13246963/SQL%20Injection">WASC-19: SQL Injection</a><br/>
<a href="http://capec.mitre.org/data/definitions/66.html">CAPEC-66: SQL Injection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/89.html">CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A1-Injection">OWASP: Top 10 2013-A1-Injection</a><br/>
<a href="https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet">OWASP: SQL Injection Prevention Cheat Sheet</a><br/>
<a href="https://www.owasp.org/index.php/Query_Parameterization_Cheat_Sheet">OWASP: Query Parameterization Cheat Sheet</a><br/>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="SQL_INJECTION_JPA"></a><h2 class="page-header">???? SQL/JPQL ???????? (JPA)  <a href="#SQL_INJECTION_JPA" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
SQL ????????????????????????????
??????????????????????SQL ???????????????????????????????????
</p>
<p>
    <b>??????:</b><br/>
    <pre>
EntityManager pm = getEM();

TypedQuery<UserEntity> q = em.createQuery(
    String.format("select * from Users where name = %s", username),
    UserEntity.class);

UserEntity res = q.getSingleResult();</pre>
</p>
<p>
    <b>???:</b><br/>
    <pre>
TypedQuery<UserEntity> q = em.createQuery(
    "select * from Users where name = usernameParam",UserEntity.class)
    .setParameter("usernameParam", username);

UserEntity res = q.getSingleResult();</pre>
</p>
<br/>
<p>
<b>???? (JPA)</b><br/>
<a href="http://docs.oracle.com/javaee/6/tutorial/doc/bnbrg.html">The Java EE 6 Tutorial: Creating Queries Using the Java Persistence Query Language</a><br/>
<b>???? (SQL ????????)</b><br/>
<a href="http://projects.webappsec.org/w/page/13246963/SQL%20Injection">WASC-19: SQL Injection</a><br/>
<a href="http://capec.mitre.org/data/definitions/66.html">CAPEC-66: SQL Injection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/89.html">CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A1-Injection">OWASP: Top 10 2013-A1-Injection</a><br/>
<a href="https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet">OWASP: SQL Injection Prevention Cheat Sheet</a><br/>
<a href="https://www.owasp.org/index.php/Query_Parameterization_Cheat_Sheet">OWASP: Query Parameterization Cheat Sheet</a><br/>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="SQL_INJECTION_SPRING_JDBC"></a><h2 class="page-header">???? JDBC ???????? (Spring JDBC)  <a href="#SQL_INJECTION_SPRING_JDBC" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
SQL ????????????????????????????
??????????????????????SQL ???????????????????????????????????
</p>

<p>
    <b>??????:</b><br/>
    <pre>JdbcTemplate jdbc = new JdbcTemplate();
int count = jdbc.queryForObject("select count(*) from Users where name = '"+paramName+"'", Integer.class);
</pre>
</p>
<p>
    <b>???:</b><br/>
    <pre>JdbcTemplate jdbc = new JdbcTemplate();
int count = jdbc.queryForObject("select count(*) from Users where name = ?", Integer.class, paramName);</pre>
</p>
<br/>

<b>???? (Spring JDBC)</b><br/>
<a href="http://docs.spring.io/spring-framework/docs/current/spring-framework-reference/html/jdbc.html">Spring Official Documentation: Data access with JDBC</a><br/>
<b>???? (SQL ????????)</b><br/>
<a href="http://projects.webappsec.org/w/page/13246963/SQL%20Injection">WASC-19: SQL Injection</a><br/>
<a href="http://capec.mitre.org/data/definitions/66.html">CAPEC-66: SQL Injection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/89.html">CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A1-Injection">OWASP: Top 10 2013-A1-Injection</a><br/>
<a href="https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet">OWASP: SQL Injection Prevention Cheat Sheet</a><br/>
<a href="https://www.owasp.org/index.php/Query_Parameterization_Cheat_Sheet">OWASP: Query Parameterization Cheat Sheet</a><br/>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="SQL_INJECTION_JDBC"></a><h2 class="page-header">???? JDBC ????????  <a href="#SQL_INJECTION_JDBC" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
SQL ????????????????????????????
??????????????????????SQL ???????????????????????????????????
</p>

<p>
    <b>??????:</b><br/>
    <pre>Connection conn = [...];
Statement stmt = con.createStatement();
ResultSet rs = stmt.executeQuery("update COFFEES set SALES = "+nbSales+" where COF_NAME = '"+coffeeName+"'");</pre>
</p>
<p>
    <b>???:</b><br/>
    <pre>Connection conn = [...];
conn.prepareStatement("update COFFEES set SALES = ? where COF_NAME = ?");
updateSales.setInt(1, nbSales);
updateSales.setString(2, coffeeName);</pre>
</p>
<br/>

<b>???? (JDBC)</b><br/>
<a href="http://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html">Oracle Documentation: The Java Tutorials &gt; Prepared Statements</a><br/>
<b>???? (SQL ????????)</b><br/>
<a href="http://projects.webappsec.org/w/page/13246963/SQL%20Injection">WASC-19: SQL Injection</a><br/>
<a href="http://capec.mitre.org/data/definitions/66.html">CAPEC-66: SQL Injection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/89.html">CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A1-Injection">OWASP: Top 10 2013-A1-Injection</a><br/>
<a href="https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet">OWASP: SQL Injection Prevention Cheat Sheet</a><br/>
<a href="https://www.owasp.org/index.php/Query_Parameterization_Cheat_Sheet">OWASP: Query Parameterization Cheat Sheet</a><br/>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="LDAP_INJECTION"></a><h2 class="page-header">???? LDAP ????????  <a href="#LDAP_INJECTION" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
SQL ?????LDAP ?????????????????????????????? ??????LDAP ???SQL ???????????????????????????????
?????LDAP ???????????????????LDAP ????????????????????????????????????
</p>
<p>
    <b>?????????:</b><br/>
    <pre>NamingEnumeration<SearchResult> answers = context.search("dc=People,dc=example,dc=com",
        "(uid=" + username + ")", ctrls);</pre>
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://projects.webappsec.org/w/page/13246947/LDAP%20Injection">WASC-29: LDAP Injection</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A1-Injection">OWASP: Top 10 2013-A1-Injection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/90.html">CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')</a><br/>
<a href="http://www.veracode.com/security/ldap-injection">LDAP Injection Guide: Learn How to Detect LDAP Injections and Improve LDAP Security</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="SCRIPT_ENGINE_INJECTION"></a><h2 class="page-header">????????????????????????????  <a href="#SCRIPT_ENGINE_INJECTION" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
    ???????????????????????????????????
    ???????????????????????????????????????????????????
</p>
<p>
    ??????????????????????????????????????? (???????)?
</p>

<p><b>?????????:</b></p>
<p>
<pre>
public void runCustomTrigger(String script) {
    ScriptEngineManager factory = new ScriptEngineManager();
    ScriptEngine engine = factory.getEngineByName("JavaScript");

    engine.eval(script); //??????????????
}</pre>
</p>

<p><b>???:</b></p>
<p>
"Cloudbees Rhino Sandbox" ?????????????JavaScript ???????????????<br/>
<pre>
public void runCustomTrigger(String script) {
    SandboxContextFactory contextFactory = new SandboxContextFactory();
    Context context = contextFactory.makeContext();
    contextFactory.enterContext(context);
    try {
        ScriptableObject prototype = context.initStandardObjects();
        prototype.setParentScope(null);
        Scriptable scope = context.newObject(prototype);
        scope.setPrototype(prototype);

        context.evaluateString(scope,script, null, -1, null);
    } finally {
        context.exit();
    }
}</pre>
</p>
<br/>
<p>
<b>????</b><br/>
<a href="https://github.com/cloudbees/rhino-sandbox">Cloudbees Rhino Sandbox</a>: Rhino ??????????????????????? (??????????????????)<br/>
<a href="http://codeutopia.net/blog/2009/01/02/sandboxing-rhino-in-java/">CodeUtopia.net: Sandboxing Rhino in Java</a><br/>
<a href="http://blog.h3xstream.com/2014/11/remote-code-execution-by-design.html">Remote Code Execution .. by design</a>: ??????????????????????????????????????????????????????<br/>
<a href="http://cwe.mitre.org/data/definitions/94.html">CWE-94: Improper Control of Generation of Code ('Code Injection')</a><br/>
<a href="https://cwe.mitre.org/data/definitions/95.html">CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')</a><br/>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="SPEL_INJECTION"></a><h2 class="page-header">Spring ????????????????????  <a href="#SPEL_INJECTION" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
    Spring ?????????????????
    ????????????????????????????????????????????????????????
</p>
<p><b>?????????:</b></p>
<p>
<pre>
public void parseExpressionInterface(Person personObj,String property) {

        ExpressionParser parser = new SpelExpressionParser();

        //???????????????????..
        Expression exp = parser.parseExpression(property+" == 'Albert'");

        StandardEvaluationContext testContext = new StandardEvaluationContext(personObj);
        boolean result = exp.getValue(testContext, Boolean.class);
[...]</pre>
</p>
<br/>
<p>
    <b>????</b><br/>
    <a href="http://cwe.mitre.org/data/definitions/95.html">CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')</a><br/>
    <a href="http://cwe.mitre.org/data/definitions/94.html">CWE-94: Improper Control of Generation of Code ('Code Injection')</a><br/>
    <a href="http://docs.spring.io/spring-framework/docs/3.2.x/spring-framework-reference/html/expressions.html">Spring Expression Language (SpEL) - Official Documentation</a><br/>
    <a href="https://www.mindedsecurity.com/fileshare/ExpressionLanguageInjection.pdf">Minded Security: Expression Language Injection</a><br/>
    <a href="http://blog.h3xstream.com/2014/11/remote-code-execution-by-design.html">Remote Code Execution .. by design</a>: ??????????????????????????????????????????????????????<br/>
</p>


        
    </section>
    
    <section>
        <a class="anchor" name="BAD_HEXA_CONVERSION"></a><h2 class="page-header">????16?????  <a href="#BAD_HEXA_CONVERSION" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>????????????????????????????????????????????????????????????????????
?????????????????????????????????????? Integer.toHexString() ?????????
<pre>
MessageDigest md = MessageDigest.getInstance("SHA-1");
byte[] resultBytes = md.digest(password.getBytes("UTF-8"));

StringBuilder stringBuilder = new StringBuilder();
for(byte b :resultBytes) {
    stringBuilder.append( Integer.toHexString( b & 0xFF ) );
}

return stringBuilder.toString();</pre>
</p>
<p>
???????????????????????????????????
??????????????????? "0x0679" ? "0x6709" ????? "679" ???????????
</p>

<p>
??????????????? toHexString() ???? String.format() ??????????:
<pre>
stringBuilder.append( String.format( "%02X", b ) );</pre>
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://cwe.mitre.org/data/definitions/704.html">CWE-704: Incorrect Type Conversion or Cast</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="HAZELCAST_SYMMETRIC_ENCRYPTION"></a><h2 class="page-header">Hazelcast ??????  <a href="#HAZELCAST_SYMMETRIC_ENCRYPTION" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>Hazelcast ??????????????? (???? DES ??? blowfish) ?????????????????</p>
<p>?????????????????????????????????????????????????</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://projects.webappsec.org/w/page/13246945/Insufficient%20Transport%20Layer%20Protection">WASC-04: Insufficient Transport Layer Protection</a><br/>
<a href="http://www.hazelcast.com/documentation.jsp#Encryption">Hazelcast Documentation: Encryption (see second part)</a><br/>
<a href="http://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="NULL_CIPHER"></a><h2 class="page-header">NullCipher ???  <a href="#NULL_CIPHER" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
NullCipher ????????????????????????????????????????????????????????? Cipher ????????????????
??????????????????? NullCipher ????????????
</p>
<p>
    <b>??????:</b><br/>
<pre>Cipher doNothingCihper = new NullCipher();
[...]
//????????????????????
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
    <b>???:</b><br/>
    NullCipher ??????????????????????????????????????
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://cwe.mitre.org/data/definitions/327.html">CWE-327: Use of a Broken or Risky Cryptographic Algorithm</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="UNENCRYPTED_SOCKET"></a><h2 class="page-header">?????????????  <a href="#UNENCRYPTED_SOCKET" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
????????????????????????????????????????????????????????????????????????
</p>
<p>
<b>??????:</b><br/>
???????? (????):
<pre>Socket soc = new Socket("www.google.com",80);</pre>
</p>
<p>
<b>???:</b><br/>
SSL ???? (?????):
<pre>Socket soc = SSLSocketFactory.getDefault().createSocket("www.google.com", 443);</pre>
</p>
<p>SSL ??????????????????? SSLSocketFactory ?????????????????????????????????????????????????????????????
????????????????OWASP Transport Layer Protection Cheat Sheet ?????????
</p>
<br/>
<p>
<b>????</b><br/>
<a href="https://www.owasp.org/index.php/Top_10_2010-A9">OWASP: Top 10 2010-A9-Insufficient Transport Layer Protection</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A6-Sensitive_Data_Exposure">OWASP: Top 10 2013-A6-Sensitive Data Exposure</a><br/>
<a href="https://www.owasp.org/index.php/Transport_Layer_Protection_Cheat_Sheet">OWASP: Transport Layer Protection Cheat Sheet</a><br/>
<a href="http://projects.webappsec.org/w/page/13246945/Insufficient%20Transport%20Layer%20Protection">WASC-04: Insufficient Transport Layer Protection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/319.html">CWE-319: Cleartext Transmission of Sensitive Information</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="DES_USAGE"></a><h2 class="page-header">DES / DESede ???  <a href="#DES_USAGE" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
DES ??? DESede (3DES) ??????????????????????????????????
???NIST ? DES/3DES ????? AES ??????????????????
</p>
<p>
    <b>????????:</b>
<pre>Cipher c = Cipher.getInstance("DESede/ECB/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
    <b>?????:</b>
    <pre>Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://www.nist.gov/itl/fips/060205_des.cfm">NIST Withdraws Outdated Data Encryption Standard</a><br/>
<a href="http://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="RSA_NO_PADDING"></a><h2 class="page-header">RSA NoPadding ???  <a href="#RSA_NO_PADDING" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
??????????RSA ????????????????????????????? (OAEP) ????????????????????????????
</p>
<p>
<b>??????:</b><br/>
<pre>Cipher.getInstance("RSA/NONE/NoPadding")</pre>
</p>
<p>
<b>???:</b><br/>
????????????????:<br/>
<pre>Cipher.getInstance("RSA/ECB/OAEPWithMD5AndMGF1Padding")</pre>
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://cwe.mitre.org/data/definitions/780.html">CWE-780: Use of RSA Algorithm without OAEP</a><br/>
<a href="http://rdist.root.org/2009/10/06/why-rsa-encryption-padding-is-critical/">Root Labs: Why RSA encryption padding is critical</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="HARD_CODE_PASSWORD"></a><h2 class="page-header">??????????????  <a href="#HARD_CODE_PASSWORD" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
????????????????????????????????????????????????????????????????????????????
???????????????????????????????????????????????????
(?????????????<i>??????????</i>???????????)
</p>
<p>
<p><b>??????:</b><br/>

<pre>private String SECRET_PASSWORD = "letMeIn!";

Properties props = new Properties();
props.put(Context.SECURITY_CREDENTIALS, "p@ssw0rd");</pre>
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://cwe.mitre.org/data/definitions/259.html">CWE-259: Use of Hard-coded Password</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="HARD_CODE_KEY"></a><h2 class="page-header">??????????  <a href="#HARD_CODE_KEY" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
???????????????????????????????????????????????????????????????????????????
???????????????????????????????????????????????????
(?????????????????<i>??????????????</i>???????????)
</p>
<p>
<p><b>??????:</b><br/>

<pre>byte[] key = {1, 2, 3, 4, 5, 6, 7, 8};
SecretKeySpec spec = new SecretKeySpec(key, "AES");
Cipher aes = Cipher.getInstance("AES");
aes.init(Cipher.ENCRYPT_MODE, spec);
return aesCipher.doFinal(secretData);</pre> 
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://cwe.mitre.org/data/definitions/321.html">CWE-321: Use of Hard-coded Cryptographic Key</a><br/>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="STRUTS_FORM_VALIDATION"></a><h2 class="page-header">??????? Struts ????  <a href="#STRUTS_FORM_VALIDATION" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
????????????????????????????????????????????????????
</p>
<p>
???? <code>validate</code> ???????????????????
<pre>
public class RegistrationForm extends ValidatorForm {

    private String name;
    private String email;

    [...]

    public ActionErrors validate(ActionMapping mapping, HttpServletRequest request) {
        //HttpRequest ??????????????????????????????????
    }
}
</pre>
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a><br/>
<a href="http://cwe.mitre.org/data/definitions/106.html">CWE-106: Struts: Plug-in Framework not in Use</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="XSS_REQUEST_WRAPPER"></a><h2 class="page-header">XSSRequestWrapper ???? XSS ??  <a href="#XSS_REQUEST_WRAPPER" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
<code>XSSRequestWrapper</code> ????? <code>HttpServletRequestWrapper</code> ?????????????????????????
<sup><a href="http://java.dzone.com/articles/stronger-anti-cross-site">[1]</a></sup>
<sup><a href="http://www.javacodegeeks.com/2012/07/anti-cross-site-scripting-xss-filter.html">[2]</a></sup>
</p>
<p>
??????????????????????????:
<ul>
<li>???????????????????????????????????????????</li>
<li>?????????????? (???????)</li>
<li>???????????????????? (????????/????????????????)</li>
</ul>
</p>
<p>
<b>????:</b><br/>
</p>
<pre>&lt;scrivbscript:pt&gt;alert(1)&lt;/scrivbscript:pt&gt;</pre>
<p>
?????? <b><code>"&lt;script&gt;alert(1)&lt;/script&gt;"</code></b> ????????
<code>"vbscript:"</code> ?????<code>"&lt;script&gt;.*&lt;/script&gt;"</code> ????????????
</p>
<p>
???????????OWASP XSS Prevention Cheat Sheet ?????? XSS ????????????<b><u>???</u></b> (???????jsp?...) ?????????????????????????????
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://projects.webappsec.org/w/page/13246920/Cross%20Site%20Scripting">WASC-8: Cross Site Scripting</a><br/>
<a href="https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet">OWASP: XSS Prevention Cheat Sheet</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_%28XSS%29">OWASP: Top 10 2013-A3: Cross-Site Scripting (XSS)</a><br/>
<a href="http://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="BLOWFISH_KEY_SIZE"></a><h2 class="page-header">?????? Blowfish ???  <a href="#BLOWFISH_KEY_SIZE" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
Blowfish ????32 ????? 448 ???????????????????????????????????????????????????
Blowfish ????????????????????????? 128 ???????????????????????
</p>
<p>
????????????????AES ??????????????????????
</p>

<p><b>??????:</b><br/>
<pre>KeyGenerator keyGen = KeyGenerator.getInstance("Blowfish");
keyGen.init(64);</pre>
</p>

<p><b>???:</b><br/>
<pre>KeyGenerator keyGen = KeyGenerator.getInstance("Blowfish");
keyGen.init(128);</pre>
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://en.wikipedia.org/wiki/Blowfish_(cipher)">Blowfish (cipher)</a><br/>
<a href="http://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="RSA_KEY_SIZE"></a><h2 class="page-header">?????? RSA ???  <a href="#RSA_KEY_SIZE" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p><q>RSA ???????????????? 1024 ?????????????????????????????????? 2048 ???????????????</q>
<sup>[1]</sup></p>

<p><b>??????:</b><br/>
<pre>
KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");
keyGen.initialize(512);
</pre>
</p>

<p><b>???:</b><br/>
KeyPairGenerator ??????????????? 2048 ??????????????<br/>
<pre>
KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");
keyGen.initialize(2048);
</pre>
</p>
<br/>
<p>
<b>????</b><br/>
[1] <a href="http://www.emc.com/emc-plus/rsa-labs/standards-initiatives/how-large-a-key-should-be-used.htm">RSA Laboratories: 3.1.5 How large a key should be used in the RSA cryptosystem?</a><br/>
<a href="http://en.wikipedia.org/wiki/Key_size#Asymmetric%5Falgorithm%5Fkey%5Flengths">Wikipedia: Asymmetric algorithm key lengths</a><br/>
<a href="http://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a><br/>
<a href="http://www.keylength.com/en/compare/">Keylength.com (BlueKrypt): Aggregate key length recommendations.</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="UNVALIDATED_REDIRECT"></a><h2 class="page-header">??????????  <a href="#UNVALIDATED_REDIRECT" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
    ?????????????????????????????????????? URL ??????????????????????????????????
    ???????????????????????????????????????
</p>
<p>
    <b>????</b><br/>
    1. ?????????????? URL ????: http://website.com/login?redirect=http://evil.vvebsite.com/fake/login<br/>
    2. ????????? Web ?????????????????????????????? (http://evil.vvebsite.com/fake/login)<br/>
    3. ???????????????<br/>
    4. ???????????????????????????? Web ?????????????<br/>
    <br/>
    ???????????????????????? URL ????????????????????
    ??????????????????????????
</p>
<p>
    <b>??????:</b></br/>
    <pre>protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
    [...]
    resp.sendRedirect(req.getParameter("redirectUrl"));
    [...]
}</pre>
</p>
<p>
    <b>???/??:</b><br/>
    <ul>
        <li>????????????????????</li>
        <li>???????????????????? (???) ????????????</li>
        <li>????????????</li>
        <li>URL ???????? (??????)</li>
        <li>URL ???????????????????????</li>
    </ul>
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://projects.webappsec.org/w/page/13246981/URL%20Redirector%20Abuse">WASC-38: URL Redirector Abuse</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A10-Unvalidated_Redirects_and_Forwards">OWASP: Top 10 2013-A10: Unvalidated Redirects and Forwards</a><br/>
<a href="https://www.owasp.org/index.php/Unvalidated_Redirects_and_Forwards_Cheat_Sheet">OWASP: Unvalidated Redirects and Forwards Cheat Sheet</a><br/>
<a href="http://cwe.mitre.org/data/definitions/601.html">CWE-601: URL Redirection to Untrusted Site ('Open Redirect')</a>
</p>
            
        
    </section>
    
    <section>
        <a class="anchor" name="XSS_JSP_PRINT"></a><h2 class="page-header">JSP ?????? XSS  <a href="#XSS_JSP_PRINT" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>???? XSS ????????????????????????????? JavaScript ?????????????????????? (?????????????)
</p>
<p>
    <b>??????:</b>
    <pre><%
String taintedInput = (String) request.getAttribute("input");
%>
[...]
<%= taintedInput %></pre>
</p>
<p>
    <b>???:</b>
    <pre>
<%
String taintedInput = (String) request.getAttribute("input");
%>
[...]
<%= Encode.forHtml(taintedInput) %>
    </pre>
</p>
<p>
XSS ????????????????????????????????????????
????? 4 ??????????????: HTML?JavaScript?CSS (????)???? URL?
?????????????????? OWASP XSS Prevention Cheat Sheet ?????? XSS ??????????????
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://projects.webappsec.org/w/page/13246920/Cross%20Site%20Scripting">WASC-8: Cross Site Scripting</a><br/>
<a href="https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet">OWASP: XSS Prevention Cheat Sheet</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_%28XSS%29">OWASP: Top 10 2013-A3: Cross-Site Scripting (XSS)</a><br/>
<a href="http://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a><br/>
<a href="https://code.google.com/p/owasp-java-encoder/">OWASP Java Encoder</a><br/>
</p>
            
        
    </section>
    
    <section>
        <a class="anchor" name="XSS_SERVLET"></a><h2 class="page-header">???????? ???? XSS  <a href="#XSS_SERVLET" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
???? XSS ????????????????????????????? JavaScript ?????????????????????? (?????????????)
</p>
<p>
    <b>??????:</b>
<pre>protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
    String input1 = req.getParameter("input1");
    [...]
    resp.getWriter().write(input1);
}</pre>
</p>
<p>
    <b>???:</b>
<pre>protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
    String input1 = req.getParameter("input1");
    [...]
    resp.getWriter().write(Encode.forHtml(input1));
}</pre>
</p>
<p>
XSS ????????????????????????????????????????
????? 4 ??????????????: HTML?JavaScript?CSS (????)???? URL?
?????????????????? OWASP XSS Prevention Cheat Sheet ?????? XSS ??????????????
</p>
<p>
?????????? XSS ????????????????FindBugs ???????XSS: ????????????????????????????????XSS: ???????????????????????????????????????????????????????????????
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://projects.webappsec.org/w/page/13246920/Cross%20Site%20Scripting">WASC-8: Cross Site Scripting</a><br/>
<a href="https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet">OWASP: XSS Prevention Cheat Sheet</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_%28XSS%29">OWASP: Top 10 2013-A3: Cross-Site Scripting (XSS)</a><br/>
<a href="http://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a><br/>
<a href="https://code.google.com/p/owasp-java-encoder/">OWASP Java Encoder</a><br/>
</p>
            
        
    </section>
    
    <section>
        <a class="anchor" name="XML_DECODER"></a><h2 class="page-header">XMLDecoder ???  <a href="#XML_DECODER" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
    XMLDecoder ????????????????????????????????
    ???????????????????????????????????????
    XMLDecoder ????????????????????????????????
    ???????????????????????????????????????????????????
</p>
<p>
    <b>????? XML ??:</b>
</p>
<pre>
&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;java version="1.4.0" class="java.beans.XMLDecoder"&gt;
  &lt;object class="java.io.PrintWriter"&gt;
    &lt;string>/tmp/Hacked.txt&lt;/string&gt;
    &lt;void method="println"&gt;
      &lt;string>Hello World!&lt;/string&gt;
    &lt;/void&gt;
    &lt;void method="close"/&gt;
  &lt;/object&gt;
&lt;/java&gt;
</pre>
<p>
??? XML ????????"Hello World!" ??????????????????????
</p>
<p>
    <b>??????:</b></br/>
    <pre>XMLDecoder d = new XMLDecoder(in);
try {
    Object result = d.readObject();
}
[...]</pre>
</p>
<p>
<b>???:</b></br/>
?????????????????????????? XMLDecoder ????????????????
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://blog.diniscruz.com/2013/08/using-xmldecoder-to-execute-server-side.html">Dinis Cruz Blog: Using XMLDecoder to execute server-side Java Code on an Restlet application</a><br/>
<a href="https://securityblog.redhat.com/2014/01/23/java-deserialization-flaws-part-2-xml-deserialization/">RedHat blog : Java deserialization flaws: Part 2, XML deserialization</a><br/>
<a href="http://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a>
</p>
            
        
    </section>
    
    <section>
        <a class="anchor" name="STATIC_IV"></a><h2 class="page-header">??? IV  <a href="#STATIC_IV" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
    ???????????????????????????????????
</p>
<p><b>??????:</b></p>
<p>
<pre>
private static byte[] IV = new byte[16] {(byte)0,(byte)1,(byte)2,[...]};

public void encrypt(String message) throws Exception {

    IvParameterSpec ivSpec = new IvParameterSpec(IV);
[...]
</pre>
<p><b>???:</b></p>
<p>
<pre>
public void encrypt(String message) throws Exception {

    byte[] iv = new byte[16];
    new SecureRandom().nextBytes(iv);

    IvParameterSpec ivSpec = new IvParameterSpec(iv);
[...]
</pre>
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://en.wikipedia.org/wiki/Initialization_vector">Wikipedia: Initialization vector</a><br/>
<a href="http://cwe.mitre.org/data/definitions/329.html">CWE-329: Not Using a Random IV with CBC Mode</a><br/>
<a href="https://defuse.ca/cbcmodeiv.htm">Encryption - CBC Mode IV: Secret or Not?</a>
</p>
            
        
    </section>
    
    <section>
        <a class="anchor" name="ECB_MODE"></a><h2 class="page-header">ECB ??????  <a href="#ECB_MODE" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>???????????????????????????????????? Electronic Codebook (ECB) ?????????????????
?????ECB ???????????????????????
?????????????????????????????????????????????????
??????????????????</p>
<p>
??????????Galois/Counter Mode (GCM) ????????????????????
</p>
<p>
<b>?????????:</b>
    <pre>Cipher c = Cipher.getInstance("AES/ECB/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
    <b>???:</b>
    <pre>Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<br/>
<p>
<b>????</b><br/>
<a href="http://en.wikipedia.org/wiki/Authenticated_encryption">Wikipedia: Authenticated encryption</a><br/>
<a href="http://csrc.nist.gov/groups/ST/toolkit/BCM/modes_development.html#01">NIST: Authenticated Encryption Modes</a><br/>
<a href="http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation#Electronic_codebook_.28ECB.29">Wikipedia: Block cipher modes of operation</a><br/>
<a href="http://csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf">NIST: Recommendation for Block Cipher Modes of Operation</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="PADDING_ORACLE"></a><h2 class="page-header">????????????????????  <a href="#PADDING_ORACLE" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        

<p>
    ???????? (PKCS5Padding ???? CBC) ??????????????????????
    ????????????????????????????????????????????????????????????????????
    ????????????????????????????????????????????????????????
</p>
<p>
    <b>?????????:</b>
    <pre>Cipher c = Cipher.getInstance("AES/CBC/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
    <b>???:</b>
    <pre>Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<br/>
<p>
    <b>????</b><br/>
    <a href="http://www.infobytesec.com/down/paddingoracle_openjam.pdf">Padding Oracles for the masses (by Matias Soler)</a><br/>
    <a href="http://en.wikipedia.org/wiki/Authenticated_encryption">Wikipedia: Authenticated encryption</a><br/>
    <a href="http://csrc.nist.gov/groups/ST/toolkit/BCM/modes_development.html#01">NIST: Authenticated Encryption Modes</a><br/>
    <a href="http://capec.mitre.org/data/definitions/463.html">CAPEC: Padding Oracle Crypto Attack</a><br/>
    <a href="http://cwe.mitre.org/data/definitions/696.html">CWE-696: Incorrect Behavior Order</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="CIPHER_INTEGRITY"></a><h2 class="page-header">?????????  <a href="#CIPHER_INTEGRITY" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        

<p>
    ???????????????????????????????????????????????????????????????????????????
    ??????????????????????????????????????
</p>
<p>
    ?????????????????????????????????  (HMAC) ???????????????
    ?????? HMAC ??????????????????????? <sup><a href="http://www.thoughtcrime.org/blog/the-cryptographic-doom-principle/">[1]</a></sup>?
    ????????? HMAC ?????????????????????????????????????????????????????????????
</p>
<p>
    <b>?????????:</b><br/>
    <i>CBC ???? AES</i><br/>

    <pre>Cipher c = Cipher.getInstance("AES/CBC/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
    <br/>
    <i>ECB ???????? DES</i><br/>

<pre>Cipher c = Cipher.getInstance("DESede/ECB/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
    <b>???:</b>
    <pre>Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
???????????GCM ?????????????????????????????? HMAC ???????
</p>
<br/>
<p>
    <b>????</b><br/>
    <a href="http://en.wikipedia.org/wiki/Authenticated_encryption">Wikipedia: Authenticated encryption</a><br/>
    <a href="http://csrc.nist.gov/groups/ST/toolkit/BCM/modes_development.html#01">NIST: Authenticated Encryption Modes</a><br/>
    <a href="http://www.thoughtcrime.org/blog/the-cryptographic-doom-principle/">Moxie Marlinspike's blog: The Cryptographic Doom Principle</a><br/>
    <a href="http://cwe.mitre.org/data/definitions/353.html">CWE-353: Missing Support for Integrity Check</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="ESAPI_ENCRYPTOR"></a><h2 class="page-header">ESAPI Encryptor ???  <a href="#ESAPI_ENCRYPTOR" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        

<p>
    ESAPI ?????????????????????????????????
    ?????????????????????????????????????????????
</p>
<p><b>1. ????????????</b></p>
<p>
    ??????ESAPI ?????? 2.1.0 ??????????????? 2.0.1 ????MAC ???????????? (CVE-2013-5679)?<br/>
</p>
<p>
    Maven ????????????? <a href="http://mojo.codehaus.org/versions-maven-plugin/">versions</a>  ????????????????????????
    ESAPI ???????????????????????<br/>
    <pre>$ mvn versions:display-dependency-updates</pre>
    <br/>??:<br/>
    <pre>
[...]
[INFO] The following dependencies in Dependencies have newer versions:
[INFO]   org.slf4j:slf4j-api ................................... 1.6.4 -> 1.7.7
[INFO]   org.owasp.esapi:esapi ................................. 2.0.1 -> 2.1.0
[...]
    </pre>
</p>
<p>
    ?????????????????<br/>
    <pre>
&lt;dependency&gt;
    &lt;groupId&gt;org.owasp.esapi&lt;/groupId&gt;
    &lt;artifactId&gt;esapi&lt;/artifactId&gt;
    &lt;version&gt;2.1.0&lt;/version&gt;
&lt;/dependency&gt;</pre>
</p>
<p>
    Ant ????????????? jar ? <a href="http://repo1.maven.org/maven2/org/owasp/esapi/esapi/2.1.0/esapi-2.1.0.jar">esapi-2.1.0.jar</a> ???????????
</p>
<p><b>2. ??:</b></p>
    <p>
    ?????????????? 2.1.0 ??????????????????????????? (CVE-2013-5960)?????????????????????<br/>
    <br/>
    <div><b>???????????????????ESAPI ????????????????????:</b><br/>
    <b>???????:</b><br/>
    <pre>
Encryptor.CipherText.useMAC=false

Encryptor.EncryptionAlgorithm=AES
Encryptor.CipherTransformation=AES/CBC/PKCS5Padding

Encryptor.cipher_modes.additional_allowed=CBC</pre>
    </div>
</p>
<p>
    <div>
    <b>?????:</b><br/>
    <pre>
#???????????
Encryptor.CipherText.useMAC=true

#???????????????????????
Encryptor.EncryptionAlgorithm=AES
Encryptor.CipherTransformation=AES/GCM/NoPadding

#???????????????? CBC ???????????????
Encryptor.cipher_modes.additional_allowed=</pre>
    </div>
</p>
<br/>
<p>
    <b>????</b><br/>
    <a href="http://owasp-esapi-java.googlecode.com/svn/trunk/documentation/ESAPI-security-bulletin1.pdf">ESAPI Security bulletin 1 (CVE-2013-5679)</a><br/>
    <a href="http://nvd.nist.gov/view/vuln/detail?vulnId=CVE-2013-5679">Vulnerability Summary for CVE-2013-5679</a><br/>
    <a href="http://www.synacktiv.com/ressources/synacktiv_owasp_esapi_hmac_bypass.pdf">Synactiv: Bypassing HMAC validation in OWASP ESAPI symmetric encryption</a><br/>
    <a href="http://cwe.mitre.org/data/definitions/310.html">CWE-310: Cryptographic Issues</a><br/>
    <a href="http://lists.owasp.org/pipermail/esapi-dev/2015-March/002533.html">ESAPI-dev mailing list: Status of CVE-2013-5960</a><br/>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="ANDROID_EXTERNAL_FILE_ACCESS"></a><h2 class="page-header">?????????? (Android)  <a href="#ANDROID_EXTERNAL_FILE_ACCESS" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
    ?????????????????? (SD ??????????????) ????????????????????????????????????????
    ??? SD ????????????? <a href="http://developer.android.com/reference/android/Manifest.permission.html#READ_EXTERNAL_STORAGE"><code>READ_EXTERNAL_STORAGE</code></a> ?????????????????????????????
    ??????????????????????????????????????????????
</p>
<p>
    <b>?????????:</b><br/>
<pre>
file file = new File(getExternalFilesDir(TARGET_TYPE), filename);
fos = new FileOutputStream(file);
fos.write(confidentialData.getBytes());
fos.flush();
</pre>
</p>
<p>
    <b>????????:</b><br/>
<pre>
fos = openFileOutput(filename, Context.MODE_PRIVATE);
fos.write(string.getBytes());
</pre>
</p>
<br/>
<p>
    <b>????</b><br/>
    <a href="http://developer.android.com/training/articles/security-tips.html#ExternalStorage">Android Official Doc: Security Tips</a><br/>
    <a href="https://www.securecoding.cert.org/confluence/display/java/DRD00-J.+Do+not+store+sensitive+information+on+external+storage+%28SD+card%29+unless+encrypted+first">CERT: DRD00-J: Do not store sensitive information on external storage [...]</a><br/>
    <a href="http://developer.android.com/guide/topics/data/data-storage.html#filesExternal">Android Official Doc: Using the External Storage</a><br/>
    <a href="https://www.owasp.org/index.php/Mobile_Top_10_2014-M2">OWASP Mobile Top 10 2014-M2: Insecure Data Storage</a><br/>
    <a href="https://cwe.mitre.org/data/definitions/312.html">CWE-312: Cleartext Storage of Sensitive Information</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="ANDROID_BROADCAST"></a><h2 class="page-header">???????? (Android)  <a href="#ANDROID_BROADCAST" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
    ???????????????????????????????????????????????
    ??????????????????????????
</p>
<p>
    <b>?????????:</b><br/>
<pre>
Intent i = new Intent();
i.setAction("com.insecure.action.UserConnected");
i.putExtra("username", user);
i.putExtra("email", email);
i.putExtra("session", newSessionId);

this.sendBroadcast(v1);
</pre>
</p>
<br/>
<p>
    <b>??? (????):</b><br/>
<pre>
Intent i = new Intent();
i.setAction("com.secure.action.UserConnected");

sendBroadcast(v1);
</pre>
</p>
<br/>
<p>
    <b>?? (?????)<sup>[1] ??: StackOverflow</sup>:</b><br/>
<pre>
&lt;manifest ...&gt;

    &lt;!-- Permission declaration --&gt;
    &lt;permission android:name="my.app.PERMISSION" /&gt;

    &lt;receiver
        android:name="my.app.BroadcastReceiver"
        android:permission="com.secure.PERMISSION"&gt; &lt;!-- Permission enforcement --&gt;
        &lt;intent-filter>
            &lt;action android:name="com.secure.action.UserConnected" /&gt;
        &lt;/intent-filter&gt;
    &lt;/receiver&gt;

    ...
&lt;/manifest>
</pre>
</p>
<p>
    <b>?? (?????)<sup>[1] ??: StackOverflow</sup>:</b><br/>
<pre>
&lt;manifest&gt;
    &lt;!-- We declare we own the permission to send broadcast to the above receiver --&gt;
    &lt;uses-permission android:name="my.app.PERMISSION" /&gt;
&lt;/manifest&gt;
</pre>
</p>
<br/>
<p>
    <b>????</b><br/>
    <a href="https://www.securecoding.cert.org/confluence/display/java/DRD03-J.+Do+not+broadcast+sensitive+information+using+an+implicit+intent">CERT: DRD03-J. Do not broadcast sensitive information using an implicit intent</a><br/>
    <a href="http://developer.android.com/reference/android/content/BroadcastReceiver.html#Security">Android Official Doc: BroadcastReceiver (Security)</a><br/>
    <a href="http://developer.android.com/guide/topics/manifest/receiver-element.html">Android Official Doc: Receiver configuration (see <code>android:permission</code>)</a><br/>
    <sup>[1]</sup> <a href="http://stackoverflow.com/a/21513368/89769">StackOverflow: How to set permissions in broadcast sender and receiver in android</a><br/>
    <a href="https://cwe.mitre.org/data/definitions/925.html">CWE-925: Improper Verification of Intent by Broadcast Receiver</a><br/>
    <a href="https://cwe.mitre.org/data/definitions/927.html">CWE-927: Use of Implicit Intent for Sensitive Communication</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="ANDROID_WORLD_WRITABLE"></a><h2 class="page-header">????????????? (Android)  <a href="#ANDROID_WORLD_WRITABLE" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
    ?????????????????????????? <code>MODE_WORLD_READABLE</code> ?????????
    ??????????????????????????????????????????
</p>
<p>
    <b>?????????:</b><br/>
<pre>
fos = openFileOutput(filename, MODE_WORLD_READABLE);
fos.write(userInfo.getBytes());
</pre>
</p>
<br/>
<p>
    <b>??? (MODE_PRIVATE ????):</b><br/>
<pre>
fos = openFileOutput(filename, MODE_PRIVATE);
</pre>
</p>
<p>
    <b>??? (???? SQLite ??????????):</b><br/>

    ???? SQLite ??????????????????????????????????????????????
    ??????????????????????????????????????????????????????????????????????
</p>
<br/>
<p>
    <b>????</b><br/>
    <a href="https://www.securecoding.cert.org/confluence/display/java/DRD11-J.+Ensure+that+sensitive+data+is+kept+secure">CERT: DRD11-J. Ensure that sensitive data is kept secure</a><br/>
    <a href="http://developer.android.com/training/articles/security-tips.html#InternalStorage">Android Official Doc: Security Tips</a><br/>
    <a href="http://developer.android.com/reference/android/content/Context.html#MODE_PRIVATE">Android Official Doc: Context.MODE_PRIVATE</a><br/>
    <a href="http://www.vogella.com/tutorials/AndroidSQLite/article.html#databasetutorial_database">vogella.com: Android SQLite database and content provider - Tutorial</a><br/>
    <a href="https://www.owasp.org/index.php/Mobile_Top_10_2014-M2">OWASP Mobile Top 10 2014-M2: Insecure Data Storage</a><br/>
    <a href="https://cwe.mitre.org/data/definitions/312.html">CWE-312: Cleartext Storage of Sensitive Information</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="ANDROID_GEOLOCATION"></a><h2 class="page-header">????????????? WebView (Android)  <a href="#ANDROID_GEOLOCATION" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
    ????????????????????????????????????
</p>
<p>
    <b>?????????:</b><br/>
<pre>
webView.setWebChromeClient(new WebChromeClient() {
    @Override
    public void onGeolocationPermissionsShowPrompt(String origin, GeolocationPermissions.Callback callback) {
        callback.invoke(origin, true, false);
    }
});
</pre>
</p>
<p>
    <b>???????:</b><br/>

    ??????????????????????????????
<pre>
webView.setWebChromeClient(new WebChromeClient() {
    @Override
    public void onGeolocationPermissionsShowPrompt(String origin, GeolocationPermissions.Callback callback) {
        callback.invoke(origin, true, false);

        //???????????
    }
});
</pre>
</p>
<br/>
<p>
    <b>????</b><br/>
    <a href="https://www.securecoding.cert.org/confluence/display/java/DRD15-J.+Consider+privacy+concerns+when+using+Geolocation+API">CERT: DRD15-J. Consider privacy concerns when using Geolocation API</a><br/>
    <a href="http://en.wikipedia.org/wiki/W3C_Geolocation_API">Wikipedia: W3C Geolocation API</a><br/>
    <a href="http://dev.w3.org/geo/api/spec-source.html">W3C: Geolocation Specification</a><br/>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="ANDROID_WEB_VIEW_JAVASCRIPT"></a><h2 class="page-header">JavaScript ?????? WebView (Android)  <a href="#ANDROID_WEB_VIEW_JAVASCRIPT" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
    WebView ???? JavaScript ????????????? XSS ????????????????????
    ??????? XSS ???? XSS ? DOM ??? XSS ??????????????????????????<br/>
<pre>
WebView myWebView = (WebView) findViewById(R.id.webView);
WebSettings webSettings = myWebView.getSettings();
webSettings.setJavaScriptEnabled(true);
</pre>
</p>

<p>
    <b>?????????:</b><br/>
    JavaScript ???????????????????????????????????? XSS ?????????????????????????
    DOM ??? XSS ????????????? XSS ????????????????
<pre>
function updateDescription(newDescription) {
    $("#userDescription").html("<p>"+newDescription+"</p>");
}
</pre>
</p>
<br/>
<p>
    <b>????</b><br/>
    <a href="http://www.technotalkative.com/issue-using-setjavascriptenabled-can-introduce-xss-vulnerabilities-application-review-carefully/">Issue: Using setJavaScriptEnabled can introduce XSS vulnerabilities</a><br/>
    <a href="http://developer.android.com/guide/webapps/webview.html#UsingJavaScript">Android Official Doc: WebView</a><br/>
    <a href="http://projects.webappsec.org/w/page/13246920/Cross%20Site%20Scripting">WASC-8: Cross Site Scripting</a><br/>
    <a href="https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet">OWASP: XSS Prevention Cheat Sheet</a><br/>
    <a href="https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_%28XSS%29">OWASP: Top 10 2013-A3: Cross-Site Scripting (XSS)</a><br/>
    <a href="http://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a>
</p>

        
    </section>
    
    <section>
        <a class="anchor" name="ANDROID_WEB_VIEW_JAVASCRIPT_INTERFACE"></a><h2 class="page-header">Javascript ??????????? WebView (Android)  <a href="#ANDROID_WEB_VIEW_JAVASCRIPT_INTERFACE" title="Permanent link"><small><i class="fa fa-link"></i></small></a></h2>

        
            
<p>
    JavaScript ???????????? WebView ???? API ????????????? XSS ? WebView ???????????????????? JavaScript ??????????????????????
</p>

<p>
    <b>?????????:</b><br/>
    <pre>
WebView myWebView = (WebView) findViewById(R.id.webView);

myWebView.addJavascriptInterface(new FileWriteUtil(this), "fileWriteUtil");

WebSettings webSettings = myWebView.getSettings();
webSettings.setJavaScriptEnabled(true);

[...]
class FileWriteUtil {
    Context mContext;

    FileOpenUtil(Context c) {
        mContext = c;
    }

    public void writeToFile(String data, String filename, String tag) {
        [...]
    }
}
    </pre>
</p>
<br/>
<p>
    <b>????</b><br/>
    <a href="http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface%28java.lang.Object,%20java.lang.String%29">Android Official Doc: WebView.addJavascriptInterface()</a><br/>
    <a href="https://cwe.mitre.org/data/definitions/749.html">CWE-749: Exposed Dangerous Method or Function</a>
</p>

        
    </section>
    
        </div>

        <div class="col-md-1" id="rightCol">

            <div  id="sidebar_lang">
                <h4>Languages:</h4>
                <ul class="nav nav-pills nav-stacked">
                    <li><a href="bugs.htm">English</a></li>
                    <li class="active"><a href="#">Japanese</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>


<br/><br/>

<footer id="footer" class="footer hidden-print">
    <div class="container text-center">
        <div>
            Find Security Bugs 1.4.4
            <span class="hide-xs">&middot;</span>
            Created by <a target="_blank" href="https://twitter.com/h3xstream">Philippe Arteau</a>
        </div>
        <div>
            Licensed under <a href="license.htm">LGPL</a>
        </div>
    </div>
</footer>

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="js/bootstrap.min.js"></script>
<script src="js/fsb-custom.js"></script>

<!-- Google Analytics -->
<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-34839255-2']);
    _gaq.push(['_trackPageview']);

    (function () {
        var ga = document.createElement('script');
        ga.type = 'text/javascript';
        ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
    })();
</script>
</body>
</html>
